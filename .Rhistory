library(readr)
UniversalBank <- read_csv("UniversalBank.csv")
View(UniversalBank)
library(dplyr)
library(ISLR)
library(caret)
library(class)
library("tidyr")
library("tidyverse")
library("reshape2")
library("MASS")
library("MASS")
library("e1071")
Bank <- UniversalBank
DF=Bank
# Before converting
summary(DF)
DF$CreditCard = as.factor(Bank$CreditCard)
DF$`Personal Loan`= as.factor(Bank$`Personal Loan`)
DF$Online_Category<-factor(Bank$Online, levels = c(0,1))
DF$Online<-NULL
summary(DF)
str(DF)
set.seed(123)
Train.index <-sample(row.names(DF), 0.6*dim(DF)[1])
Test.index <-setdiff(row.names(DF), Train.index)
Train.df <- DF[Train.index, ]
Test.df <- DF[Test.index, ]
mytabs <-xtabs(~ CreditCard+`Personal Loan`, data = Train.df)
mytable <-xtabs(~ CreditCard+`Personal Loan`+Online_Category, data = Train.df)
ftable(mytable)
prop.table(mytable)
table(`Personal Loan`=Train.df$`Personal Loan`, Online_Category=Train.df$Online_Category)
table(`Personal Loan`=Train.df$`Personal Loan`, CreditCard=Train.df$CreditCard)
P (CreditCard = 1\ `Personal Loan` = 1)
P (CreditCard = 1| `Personal Loan` = 1)
P (CreditCard=1| `Personal Loan`=1)
mytable1 <-table(`Personal Loan`=Train.df$`Personal Loan`, Online_Category=Train.df$Online_Category)
mytable2 <-table(`Personal Loan`=Train.df$`Personal Loan`, CreditCard=Train.df$CreditCard)
library(readr)
prop.table(table1)
prop.table(mytable1)
prop.table(mytable2)
library("e1071")
round(prop.table(mytable1), 3)
round(prop.table(mytable2, 3)
round(prop.table(mytable2, 3)
round(prop.table(mytable2, 3)
mytable2 <-table(`Personal Loan`=Train.df$`Personal Loan`, CreditCard=Train.df$CreditCard)
prop.table(mytable2)
round(prop.table(mytable2, 3)
round(prop.table(mytable2),3)
library(readr)
prop.table(mytable2)
round(prop.table(mytable2),3)
round(prop.table(mytable1, 1),3)
round(prop.table(mytable2, 1),3)
prop.table(mytable)
round(prop.table(mytable, 1),3)
source("C:/Users/sakas/Desktop/NBayesAssignment3/NBayesAssignment3030222.R")
library(e1071)
library(e1071)
nb.model<-naiveBayes(Online_Category~CreditCard+`Personal Loan`, data = Train.df)
To_Predict=data.frame(CreditCard='1',`Personal Loan`='1' )
predict(nb.model, To_Predict,type = 'raw')
View(To_Predict)
naive.Train = Train.df [,c(10,13:14)]
naive.Test = Test.df[,c(10,13:14)]
naiveBayes = naiveBayes(`Personal Loan`~.,data = naive.Train)
naiveBayes
save.image("C:/Users/sakas/Desktop/NBayesAssignment3/NBayesKasturiarachiAssignment3.RData")
source("C:/Users/sakas/Desktop/NBayesAssignment3/NBayesAssignment3030222.R")
